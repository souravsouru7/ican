<!-- views/index.ejs -->

<%- include("header.ejs") %>



<style>
    #hero{
    background-image: url(img/hero4.png);
    height: 90vh;
    width: 100%;
    background-position: top 25% right 0;
    padding: 0 80px;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: center;
}

#banner{
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    background-image: url("img/banner/b2.jpg");
    width: 100%;
    height: 40vh;
    background-size: cover;
    background-position: center;

}
.banner-box2{
    background-image: url(img/banner/b10.jpg);
}
.banner-box1{
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: flex-start;
    background-image: url("img/banner/b7.jpg");
    min-width: 30%;
    height: 30vh;
    background-size: cover;
    background-position: center;
    padding: 20px;
    margin-bottom: 20px;


}
.bannerbox12{
    background-image: url(img/banner/b4.jpg);

}
.bannerbox13{
    background-image: url(img/banner/b18.jpg);
    
}

#newsletter{
    display: flex;
    justify-content: space-between;
    flex-wrap: wrap;
    align-items: center;
    background-image: url(img/banner/b14.png);
    background-repeat: no-repeat;
    background-position: 20% 30%;
    background-color: #041e42;

}
</style>
<link rel="stylesheet" href="styles/index.css">

<section id="hero">
    <h4>Trade-in-offer</h4>
    <h2>Super value deals</h2>
    <h1> on all product</h1>
    <p>Save more with coupons & up to 70% off!</p>
    <button> Shop now</button>
</section>
<section id="feature" class="section-p1">
    <div class="fe-box">
        <img src="img/features/f1.png" alt="">
            <h6>free shipping</h6>
    </div>
    <div class="fe-box">
        <img src="img/features/f2.png" alt="">
            <h6>online Order</h6>
    </div>
    <div class="fe-box">
        <img src="img/features/f3.png" alt="">
            <h6>Save Money</h6>
    </div>
    <div class="fe-box">
        <img src="img/features/f4.png" alt="">
            <h6>Promotions</h6>
    </div>
    <div class="fe-box">
        <img src="img/features/f5.png" alt="">
            <h6> happy Sell</h6>
    </div>
    <div class="fe-box">
        <img src="img/features/f6.png" alt="">
            <h6>f24/7 Support</h6>
    </div>
</section>


<section id="product1" class="section-p1">
    <h2>Featured Product</h2>
    <p>Summer Collection New MOrden Design</p>
    <div class="pro-container">
        <% if (products.length > 0) { %>
            <% products.forEach(product => { %>
                <div class="pro">
                    <img src="/uploads/<%= product.productImage %>" alt="<%= product.productName %> Image">
                    <div class="des">
                        <span><%= product.productName %></span>
                        <h5><%= product.category.name %></h5>
                        <div class="star">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <h4> RS<%= product.regularPrice.toFixed(2) %></h4>
                
                        <!-- Wishlist Button -->
                        <% if (user) { %>
                            <button class="wishlist-btn" data-product-id="<%= product._id %>">
                                <%= user.wishlist.includes(product._id) ? 'Remove from Wishlist' : 'Add to Wishlist' %>
                            </button>
                        <% } %>
                
                    </div>
                    <a href="/product/<%= product._id %>"><i class="fa-solid fa-cart-shopping cart"></i></a>
                </div>
        <% }); %>
        <% } else { %>
            <p>No products available.</p>
        <% } %>
        
    </div>

</section>
<section id="banner" class="section-m1">
    <h4>Repair service</h4>
    <h2>Up to <span>70% off</span>  - All t-shirts & Accessories</h2>
    <button class="normal">Explore more</button>


</section>

<section id="product1" class="section-p1">
    <h2>New Arrivals</h2>
        <p>Summer Collection New MOrden Design</p>
    <div class="pro-container">
        <% if (products.length > 0) { %>
            <% products.forEach(product => { %>
        <div class="pro">
            <img src="/uploads/<%= product.productImage %>" alt="<%= product.productName %> Image" alt="">
            <div class="des">
                <span> %= product.name %> </span>
                <h5><%= product.category %> </h5>
                <div class="star">
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>

                </div>
                <h4> RS<%= product.regularPrice.toFixed(2) %></h4>
                <% if (user) { %>
                    <button class="wishlist-btn" data-product-id="<%= product._id %>">
                        <%= user.wishlist.includes(product._id) ? 'Remove from Wishlist' : 'Add to Wishlist' %>
                    </button>
                <% } %>
            </div>
            <a href="/product/<%= product._id %>"><i class="fa-solid fa-cart-shopping cart"></i></a>
            

        </div>
        <% }); %>
        <% } else { %>
            <p>No products available.</p>
        <% } %>
        
    </div>

</section>
<section id="sm-banner" class="section-p1">
    <div class="banner-box">
        <h4>crazy deals</h4>
        <h2>buy 1 get 1 free</h2>
        <span>The best classic dress is on sale at cara</span>
        <button class="white">Learn More</button>

    </div>
    <div class="banner-box banner-box2">
        <h4>crazy deals</h4>
        <h2>buy 1 get 1 free</h2>
        <span>The best classic dress is on sale at cara</span>
        <button class="white">Collection</button>
        
    </div>
</section>
<section id="banner3">
    <div class="banner-box1">
        
        <h2>SEASONAL SALE</h2>
        <h3>Winter collection -50% OFF</h3>
    </div>
    <div class="banner-box1 bannerbox12">
        
        <h2>NEW GENTS collection</h2>
        <h3>Spring/Summer 2023</h3>
    </div>
    <div class="banner-box1 bannerbox13">
        
        <h2>T-shirt</h2>
        <h3>NEW TRENDY PRINTS</h3>
    </div>
</section>

<section id="newsletter" class="section-p1  section-m1">
    <div class="newstext">
        <h4>Signup Up For Newsletter</h4>
        <p>Get e-Mail updates about our latest shop and <span>sepecial offers</span></p>
       
    </div>
    <div class="form">
        <input type="text" placeholder="your  email address">
        <button class="normal">Sign up</button>
    </div>


</section>
<script>
     document.addEventListener('DOMContentLoaded', () => {
        const wishlistButtons = document.querySelectorAll('.wishlist-btn');

        wishlistButtons.forEach(button => {
            button.addEventListener('click', async () => {
                const productId = button.getAttribute('data-product-id');

                try {
                    const response = await fetch(`/api/wishlist/${productId}`, {
                        method: 'POST', // Use POST method to add to wishlist
                        headers: {
                            'Content-Type': 'application/json',
                        },
                    });

                    const data = await response.json();

                    if (data.success) {
                        // Optionally, you can update the UI to reflect the addition
                        console.log('Product added to wishlist:', data.message);

                        // Change button text after adding to wishlist
                        button.innerText = 'Remove from Wishlist';
                    } else {
                        // Product is already in the wishlist, so remove it
                        const removeResponse = await fetch(`/api/wishlist/${productId}`, {
                            method: 'DELETE', // Use DELETE method to remove from wishlist
                            headers: {
                                'Content-Type': 'application/json',
                            },
                        });

                        const removeData = await removeResponse.json();

                        if (removeData.success) {
                            // Optionally, you can update the UI to reflect the removal
                            console.log('Product removed from wishlist:', removeData.message);

                            // Change button text after removing from wishlist
                            button.innerText = 'Add to Wishlist';
                        } else {
                            console.error('Wishlist update failed:', removeData.message);
                        }
                    }
                } catch (error) {
                    console.error('Error updating wishlist:', error);
                }
            });
        });
    });
</script>

<%- include("footer.ejs") %>